datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum FunnelStage {
  top
  bottom
}

enum FacebookEventType {
  ad_view
  page_like
  comment
  video_view
  ad_click
  form_submission
  checkout_complete
}

enum TiktokEventType {
  video_view
  like
  share
  comment
  profile_visit
  purchase
  follow
}

enum Gender {
  male
  female
  non_binary
}

enum Referrer {
  newsfeed
  marketplace
  groups
}

enum ClickPosition {
  top_left
  bottom_right
  center
}

enum FacebookDevice {
  mobile
  desktop
}

enum Browser {
  Chrome
  Firefox
  Safari
}

enum TiktokDevice {
  Android
  iOS
  Desktop
}

model FacebookUser {
  userId  String          @id
  name    String
  age     Int
  gender  Gender
  country String
  city    String
  events  FacebookEvent[]
}

model FacebookEvent {
  eventId       String              @id
  timestamp     DateTime
  funnelStage   FunnelStage
  eventType     FacebookEventType

  // (FacebookEngagementTop)
  actionTime    DateTime?
  referrer      Referrer?
  videoId       String?

  // (FacebookEngagementBottom)
  adId          String?
  campaignId    String?
  clickPosition ClickPosition?
  device        FacebookDevice?
  browser       Browser?
  purchaseAmount String?

  userId        String
  user          FacebookUser        @relation(fields: [userId], references: [userId])
}

model TiktokUser {
  userId    String         @id
  username  String
  followers Int
  events    TiktokEvent[]
}

model TiktokEvent {
  eventId           String           @id
  timestamp         DateTime
  funnelStage       FunnelStage
  eventType         TiktokEventType

  // (TiktokEngagementTop)
  watchTime         Float?
  percentageWatched Float?
  tiktokDevice      TiktokDevice?
  country           String?
  videoId           String?

  // (TiktokEngagementBottom)
  actionTime        DateTime?
  profileId         String? 
  purchasedItem     String?  
  purchaseAmount    String? 

  userId            String
  user              TiktokUser       @relation(fields: [userId], references: [userId])
}
